document.addEventListener('DOMContentLoaded',function(){initNavigation();initScrollAnimations();initProjectFilters();initContactForm();initHeaderScroll();initSmoothScrolling()});window.addEventListener('load',function(){addLoadAnimations();registerServiceWorker()});function registerServiceWorker(){'serviceWorker'in navigator&&navigator.serviceWorker.register('/sw.js').then(function(e){console.log('SW registrado: ',e.scope)}).catch(function(e){console.log('SW registro fallido: ',e)})}function initNavigation(){const e=document.getElementById('nav-toggle'),t=document.getElementById('nav-menu'),n=document.querySelectorAll('.nav-link');e&&t&&e.addEventListener('click',function(){t.classList.toggle('active');e.classList.toggle('active')});n.forEach(e=>{e.addEventListener('click',function(){t.classList.remove('active');e.classList.remove('active')})});document.addEventListener('click',function(n){e.contains(n.target)||t.contains(n.target)||(t.classList.remove('active'),e.classList.remove('active'))})}function initHeaderScroll(){const e=document.querySelector('.header');let t=window.scrollY;function n(){const n=window.scrollY;n>100?e.classList.add('scrolled'):e.classList.remove('scrolled'),t=n}let o=!1;function i(){o||(requestAnimationFrame(n),o=!0)}window.addEventListener('scroll',function(){o=!1;i()})}function initScrollAnimations(){const e={threshold:.1,rootMargin:'0px 0px -50px 0px'},t=new IntersectionObserver(function(e){e.forEach(e=>{e.isIntersecting&&(e.target.classList.add('fade-in-up'),t.unobserve(e.target))})},e);['.section-header','.service-card','.project-card','.contact-item','.hero-text','.hero-visual'].forEach(e=>{document.querySelectorAll(e).forEach((e,n)=>{('.service-card'===e||'.project-card'===e)&&(e.style.animationDelay=.1*n+'s');t.observe(e)})})}function initProjectFilters(){const e=document.querySelectorAll('.filter-btn'),t=document.querySelectorAll('.project-card');if(0!==e.length&&0!==t.length){e.forEach(e=>{e.addEventListener('click',function(){e.forEach(e=>e.classList.remove('active'));this.classList.add('active');const n=this.getAttribute('data-filter');t.forEach((e,o)=>{const i=e.getAttribute('data-project-type');'all'===n||i===n?setTimeout(()=>{e.style.display='block';e.style.animation='fadeInUp 0.6s ease-out'},100*o):e.style.display='none'})})})}}function initContactForm(){const e=document.querySelector('.contact-form');if(e){e.addEventListener('submit',function(t){t.preventDefault();const n=new FormData(this),o=n.get('name'),i=n.get('email'),c=n.get('service'),d=n.get('message');if(!o||!i||!c||!d)return void showNotification('Por favor, completa todos los campos','error');if(!isValidEmail(i))return void showNotification('Por favor, introduce un email válido','error');const a=this.querySelector('button[type="submit"]'),s=a.innerHTML;a.innerHTML='<i class="fas fa-spinner fa-spin"></i> <span>Enviando...</span>';a.disabled=!0;fetch('/',{method:'POST',headers:{'Content-Type':'application/x-www-form-urlencoded'},body:new URLSearchParams(n).toString()}).then(function(t){t.ok?(showNotification('Mensaje enviado correctamente. Te contactaré pronto.','success'),e.reset(),setTimeout(()=>{a.innerHTML=s;a.disabled=!1},2e3)):(showNotification('Error al enviar el mensaje. Intenta nuevamente.','error'),a.innerHTML=s,a.disabled=!1)}).catch(function(){showNotification('Error de conexión. Intenta nuevamente.','error');a.innerHTML=s;a.disabled=!1})})}}function initSmoothScrolling(){document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener('click',function(t){t.preventDefault();const n=this.getAttribute('href');if('#'!==n){const t=document.querySelector(n);t&&window.scrollTo({top:t.offsetTop-80,behavior:'smooth'})}})})}function addLoadAnimations(){document.querySelectorAll('.hero-text, .hero-visual').forEach((e,t)=>{e.style.animationDelay=.3+.2*t+'s';e.classList.add('fade-in-up')})}function showNotification(e,t){const n=document.createElement('div');n.className=`notification ${t}`;n.innerHTML=`<span>${e}</span><button onclick="this.parentElement.remove()"><i class="fas fa-times"></i></button>`;document.body.appendChild(n);setTimeout(()=>n.classList.add('show'),100);setTimeout(()=>{n.classList.remove('show');setTimeout(()=>{n.remove()},300)},3e3)}function isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}